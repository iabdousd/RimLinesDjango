{% extends 'control_panel/base.html' %}
{% load static %}

{% block title %}Control Panel{% endblock %}

{% block content %}
<div class="main-content animsition">
    <div class="section__content section__content--p30">
        {#  ----------------> Delete Product Modal          #}
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="overview-wrap">
                        <h2 class="title-1">overview</h2>
                        <a href="{% url 'add_order' %}" class="au-btn au-btn-icon au-btn--blue">
                            <i class="zmdi zmdi-plus"></i>New Order
                        </a>
                    </div>
                </div>
            </div>
            <div class="row m-t-25">
                <div class="col-sm-6 col-lg-3">
                    <div class="overview-item overview-item--c1">
                        <div class="overview__inner">
                            <div class="overview-box clearfix">
                                <div class="icon">
                                    <i class="zmdi zmdi-alert-circle"></i>
                                </div>
                                <div class="text">
                                    <h2>{{ pending_orders }}</h2>
                                    <span>Orders Pending</span>
                                </div>
                            </div>
                            <div class="overview-chart">
                                <canvas id="widgetChart1"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="overview-item overview-item--c2">
                        <div class="overview__inner">
                            <div class="overview-box clearfix">
                                <div class="icon">
                                    <i class="zmdi zmdi-shopping-cart"></i>
                                </div>
                                <div class="text">
                                    <h2>{{ delivered_orders }}</h2>
                                    <span>Orders Delivered</span>
                                </div>
                            </div>
                            <div class="overview-chart">
                                <canvas id="widgetChart2"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="overview-item overview-item--c3">
                        <div class="overview__inner">
                            <div class="overview-box clearfix">
                                <div class="icon">
                                    <i class="zmdi zmdi-calendar-note"></i>
                                </div>
                                <div class="text">
                                    <h2>{{ orders_this_week }}</h2>
                                    <span>Orders this week</span>
                                </div>
                            </div>
                            <div class="overview-chart">
                                <canvas id="widgetChart3"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="overview-item overview-item--c4">
                        <div class="overview__inner">
                            <div class="overview-box clearfix">
                                <div class="icon">
                                    <i class="zmdi zmdi-money"></i>
                                </div>
                                <div class="text">
                                    <h2>{{ earnings_month }} MRU</h2>
                                    <span>Month's earnings</span>
                                </div>
                            </div>
                            <div class="overview-chart">
                                <canvas id="widgetChart4"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="au-card recent-report">
                        <div class="au-card-inner">
                            <h3 class="title-2">recent reports</h3>
                            <div class="chart-info">
                                <div class="chart-info__left">
                                    <div class="chart-note">
                                        <span class="dot dot--blue"></span>
                                        <span>products</span>
                                    </div>
                                    <div class="chart-note mr-0">
                                        <span class="dot dot--green"></span>
                                        <span>services</span>
                                    </div>
                                </div>
                                <div class="chart-info__right">
                                    <div class="chart-statis">
                                                    <span class="index incre">
                                                        <i class="zmdi zmdi-long-arrow-up"></i>25%</span>
                                        <span class="label">products</span>
                                    </div>
                                    <div class="chart-statis mr-0">
                                                    <span class="index decre">
                                                        <i class="zmdi zmdi-long-arrow-down"></i>10%</span>
                                        <span class="label">services</span>
                                    </div>
                                </div>
                            </div>
                            <div class="recent-report__chart">
                                <canvas id="recent-rep-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="au-card chart-percent-card">
                        <div class="au-card-inner">
                            <h3 class="title-2 tm-b-5">char by %</h3>
                            <div class="row no-gutters">
                                <div class="col-xl-6">
                                    <div class="chart-note-wrap">
                                        <div class="chart-note mr-0 d-block">
                                            <span class="dot dot--blue"></span>
                                            <span>products</span>
                                        </div>
                                        <div class="chart-note mr-0 d-block">
                                            <span class="dot dot--red"></span>
                                            <span>services</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="percent-chart">
                                        <canvas id="percent-chart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-md-12">
                    <!-- DATA TABLE -->
                    <h3 class="title-5 m-b-35">Products List</h3>
                    <div class="table-data__tool">
                        <div class="table-data__tool-right">
                            <a style="color: white;" class="au-btn au-btn-icon au-btn--green au-btn--small" href="{% url 'add_product' %}">
                                <i class="zmdi zmdi-plus"></i>New Product</a>
                            <div class="rs-select2--dark rs-select2--sm rs-select2--dark2">
                                <select class="js-select2" name="type">
                                    <option selected="selected">Export</option>
                                    <option value="">Option 1</option>
                                    <option value="">Option 2</option>
                                </select>
                                <div class="dropDownSelect2"></div>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive table-responsive-data2">
                        <table class="table table-data2">
                            <thead>
                            <tr>
                                <th>
                                    <label class="au-checkbox">
                                        <input type="checkbox">
                                        <span class="au-checkmark"></span>
                                    </label>
                                </th>
                                <th>name</th>
                                <th>tags</th>
                                <th>description</th>
                                <th>date</th>
                                <th>category</th>
                                <th>price</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody>
                                {% for product in products %}
                                    <tr class="tr-shadow" style="cursor: pointer;">
                                        <td>
                                            <label class="au-checkbox">
                                                <input type="checkbox">
                                                <span class="au-checkmark"></span>
                                            </label>
                                        </td>
                                        <td onclick="window.location='{% url 'product' product.id %}';">{{ product.name }}</td>
                                        <td onclick="window.location='{% url 'product' product.id %}';">
                                            {% for tag in product.tags_set.all %}
                                                <span class="block-email">{{ tag.name }}</span>
                                            {% endfor %}
                                        </td>
                                        <td class="desc" onclick="window.location='{% url 'product' product.id %}';">{{ product.description }}</td>
                                        <td>{{ product.date_created }}</td>
                                        <td onclick="window.location='{% url 'product' product.id %}';">
                                            <span class="status--process">{{ product.category }}</span>
                                        </td>
                                        <td onclick="window.location='{% url 'product' product.id %}';">{{ product.price }} MRU</td>
                                        <td>
                                            <div class="table-data-feature">
{#                                                <button class="item" data-toggle="tooltip" data-placement="top" title="Send">#}
{#                                                    <i class="zmdi zmdi-mail-send"></i>#}
{#                                                </button>#}
                                                {% if user.groups.all.0.name == 'admin' %}
                                                <a href="{% url 'edit_product' product.id %}" class="item" data-toggle="tooltip" data-placement="top" title="Edit">
                                                    <i class="zmdi zmdi-edit"></i>
                                                </a>
                                                <button id="deleteModal" class="item" onclick="deleteModal({{ product.id }}, '{{ product.name }}')" data-placement="top" title="Delete" data-toggle="tooltip">
                                                    <i class="zmdi zmdi-delete"></i>
                                                </button>
                                                {% endif %}
{#                                                <button class="item" data-toggle="tooltip" data-placement="top" title="More">#}
{#                                                    <i class="zmdi zmdi-more"></i>#}
{#                                                </button>#}
                                            </div>
                                        </td>
                                    </tr>
                                <tr class="spacer"></tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <!-- END DATA TABLE -->
                </div>
            </div>
{#            <div class="row">#}
{#                <div class="col-lg-12">#}
{#                    <h2 class="title-1 m-b-25">Last Customers</h2>#}
{#                    <div class="table-responsive table--no-card m-b-40">#}
{#                        <table class="table table-borderless table-striped table-earning">#}
{#                            <thead>#}
{#                                <tr>#}
{#                                    <th>date</th>#}
{#                                    <th>name</th>#}
{#                                    <th>email</th>#}
{#                                    <th class="text-right">Phone</th>#}
{#                                    <th class="text-right">Orders</th>#}
{#                                </tr>#}
{#                            </thead>#}
{#                            <tbody>#}
{#                                {% for customer in customers %}#}
{#                                <tr onclick="window.location='{% url 'customer' customer.id %}';">#}
{#                                    <td>{{ customer.date_created }}</td>#}
{#                                    <td>{{ customer.name }}</td>#}
{#                                    <td>{{ customer.email }}</td>#}
{#                                    <td class="text-right">{{ customer.phone }}</td>#}
{#                                    <td class="text-right"></td>#}
{#                                </tr>#}
{#                                {% endfor %}#}
{#                            </tbody>#}
{#                        </table>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
            <div class="row">
                <div class="col-lg-12">
                    <h2 class="title-1 m-b-25">Last Orders</h2>
                    <div class="table-responsive table--no-card m-b-40">
                        <table class="table table-borderless table-striped table-earning">
                            <thead>
                                <tr>
                                    <th>date</th>
                                    <th>customer</th>
                                    <th>product</th>
                                    <th class="text-right">price</th>
                                    <th class="text-right">quantity</th>
                                    <th class="text-right">status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for order in orders %}
                                <tr onclick="window.location='{% url 'order' order.id %}';">
                                    <td>{{ order.date_created }}</td>
                                    <td>{{ order.customer.name }}</td>
                                    <td>{{ order.product.name }}</td>
                                    <td class="text-right">{{ order.product.price }} MRU</td>
                                    <td class="text-right">{{ order.quantity }}</td>
                                    <td class="text-right {% if order.status == 'Delivered' %}} alert-success {% else %} alert-danger {% endif %}">{{ order.status }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% if user.groups.all.0.name == 'admin' %}
                <div class="row">
        <div class="col-lg-6 user-data au-card au-card--no-shadow au-card--no-pad m-b-40">
            <h3 class="title-3 m-b-30">
                <i class="zmdi zmdi-account-calendar"></i>Users data</h3>
            <div class="filters m-b-45">
                <div class="rs-select2--dark rs-select2--md m-r-10 rs-select2--border">
                    <select class="js-select2" name="property">
                        <option selected="selected">All Roles</option>
                        <option value="">Products</option>
                        <option value="">Services</option>
                    </select>
                    <div class="dropDownSelect2"></div>
                </div>
            </div>
            <div class="table-responsive table-data">
                <table class="table">
                    <thead>
                    <tr>
                        <td>
                            <label class="au-checkbox">
                                <input type="checkbox">
                                <span class="au-checkmark"></span>
                            </label>
                        </td>
                        <td>name</td>
                        <td>roles</td>
                        <td>update role</td>
                        <td></td>
                    </tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                            <tr>
                                <td>
                                    <label class="au-checkbox">
                                        <input type="checkbox">
                                        <span class="au-checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div class="table-data__info">
                                        <span>
                                            <a href="#">{{ user.username }}</a>
                                        </span>
                                    </div>
                                </td>
                                <td>
                                    {% for group in user.groups.all %}
                                        <span class="role admin">{{ group.name }}</span>
                                    {% endfor %}
                                </td>
                                <td>
                                    <div class="rs-select2--trans rs-select2--sm">
                                        <select class="js-select2" name="property">
{#                                                    <option value="0" selected="selected">{{ user.groups.all.0 }}</option>#}
                                            {% for role in roles %}
                                                {% if role not in user.groups.all %}
                                                    <option value="{{ role.id }}">{{ role.name }}</option>
                                                {% endif %}
                                            {% endfor %}
                                        </select>
                                        <div class="dropDownSelect2"></div>
                                    </div>
                                </td>
                                <td>
                                    <span class="more">
                                        <i class="zmdi zmdi-more"></i>
                                    </span>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="user-data__footer">
                <button class="au-btn au-btn-load">load more</button>
            </div>
        </div>
        <div class="col-lg-6">
{#                    <h2 class="title-1 m-b-25">Top countries</h2>#}
{#                    <div class="au-card au-card--bg-blue au-card-top-countries m-b-40">#}
{#                        <div class="au-card-inner">#}
{#                            <div class="table-responsive">#}
{#                                <table class="table table-top-countries">#}
{#                                    <tbody>#}
{#                                    <tr>#}
{#                                        <td>United States</td>#}
{#                                        <td class="text-right">$119,366.96</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>Australia</td>#}
{#                                        <td class="text-right">$70,261.65</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>United Kingdom</td>#}
{#                                        <td class="text-right">$46,399.22</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>Turkey</td>#}
{#                                        <td class="text-right">$35,364.90</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>Germany</td>#}
{#                                        <td class="text-right">$20,366.96</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>France</td>#}
{#                                        <td class="text-right">$10,366.96</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>Australia</td>#}
{#                                        <td class="text-right">$5,366.96</td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{#                                        <td>Italy</td>#}
{#                                        <td class="text-right">$1639.32</td>#}
{#                                    </tr>#}
{#                                    </tbody>#}
{#                                </table>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
        </div>
</div>
            {% endif %}
            <div class="row">
                <div class="col-md-12">
                    <div class="copyright">
                        <p>Copyright © 2020 <a href="https://rimlines.com">RimLines</a>. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="myModal" class="modal">
  <!-- Modal content -->
</div>
<script>
    var modal = document.getElementById("myModal");
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
    function deleteModal(id, name) {
        modal.innerHTML =
            "<div class=\"modal-content\">" +
                "<div class=\"modal-header\">" +
                    "<h2>Would you really like to remove the product, %name%?</h2>".replace("%name%", name) +
                    "<span class=\"close1312\">&times;</span>" +
                "</div>" +
                "<div class=\"modal-footer\">" +
                    '<form action=\"product/delete/%id%/\" method=\"post\">{% csrf_token %}<input type=\"submit\" value="Delete" name=\"Remove\" class=\"btn btn-lg btn-danger btn-block\"></form> '.replace("%id%", id) +
                "</div>" +
            "</div>";
        modal.style.display = "block";
        var span = document.getElementsByClassName("close1312")[0];
        span.onclick = function() {
            modal.style.display = "none";
        }
    }
</script>
{% endblock %}